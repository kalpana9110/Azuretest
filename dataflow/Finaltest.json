{
	"name": "Finaltest",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Campaigntest",
						"type": "DatasetReference"
					},
					"name": "Compaignsource"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Campaigntarget",
						"type": "DatasetReference"
					},
					"name": "Targettable"
				}
			],
			"transformations": [
				{
					"name": "MapCampaignAnalytics"
				},
				{
					"name": "derivedColumn1"
				},
				{
					"name": "removecolumns"
				}
			],
			"scriptLines": [
				"source(output(",
				"          {_Col_0} as string,",
				"          {_Col_1} as string,",
				"          {_Col_2} as string,",
				"          {_Col_3} as string,",
				"          {_Col_4} as string,",
				"          {_Col_5} as double,",
				"          {_Col_6} as string,",
				"          {_Col_7} as double",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> Compaignsource",
				"Compaignsource select(mapColumn(",
				"          Region = {_Col_0},",
				"          Country = {_Col_1},",
				"          ProductCategory = {_Col_2},",
				"          CampaignName = {_Col_3},",
				"          RevenuePart1 = {_Col_4},",
				"          Revenue = {_Col_5},",
				"          RevenueTargetPart1 = {_Col_6},",
				"          RevenueTarget = {_Col_7}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> MapCampaignAnalytics",
				"MapCampaignAnalytics derive(Revenue = toDecimal(replace(concat(toString(RevenuePart1), toString(Revenue)), '\\\\', ''), 10, 2, '$###,###.##'),",
				"          RevenueTarget = toDecimal(replace(concat(toString(RevenueTargetPart1), toString(RevenueTarget)), '\\\\', ''), 10, 2, '$###,###.##')) ~> derivedColumn1",
				"derivedColumn1 select(mapColumn(",
				"          Region,",
				"          Country,",
				"          ProductCategory,",
				"          CampaignName,",
				"          Revenue,",
				"          RevenueTarget",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> removecolumns",
				"removecolumns sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          Region as string,",
				"          Country as string,",
				"          ProductCategory as string,",
				"          CampaignName as string,",
				"          Revenue as decimal(10,2),",
				"          RevenueTarget as decimal(10,2),",
				"          City as string,",
				"          State as string",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> Targettable"
			]
		}
	}
}